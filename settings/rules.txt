
---

## **Strict Rules**

### **1. Port Assignment**

* **Never hardcode ports.**
* Derive the port by hashing the project path.
* Ensure the port falls in the range `3000–4000`.
* Example algorithm:

  ```python
  import hashlib
  port = 3000 + (int(hashlib.md5(path.encode()).hexdigest(), 16) % 1001)
  ```

---

### **2. Running the Server**

* Always run the dev server in the **background**:

  ```bash
  run dev &
  ```
* Ensure only **one instance** runs at a time (kill previous before starting new).

---

### **3. Browser Check**

* After starting the server, **validate page rendering** using headless Chrome:

  ```bash
  chrome --headless --disable-gpu --dump-dom https://example.com
  ```
* Use the dynamically assigned port instead of `example.com` if applicable.

---

### **4. Code Changes**

* After every code change:

  1. **Commit changes** (`git add . && git commit -m "update"`)
  2. **Kill the running server**
  3. **Restart server in background** with correct port
  4. **Re-run headless Chrome** to validate

---

### **5. Opening URL**

* After a successful restart and validation:

  * Open the project in default browser with:

    ```bash
    open http://localhost:$PORT
    ```

---

✅ Following these rules guarantees:

* No port conflicts
* Server runs reliably in the background
* Browser DOM validation happens automatically
* Workflow remains consistent after every update

---
